const params=new URLSearchParams(window.location.search),pesquisaUrl=params.get("search");var token=localStorage.getItem("MusicianTokenSpotifySecret");const createToken=()=>{const e=new URLSearchParams;e.append("grant_type","client_credentials"),e.append("client_id","4ac8ecaa2fcf47c1a5063769d0ae79e8"),e.append("client_secret","5c1e6b5fb0664185975d44e6293229f1"),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then((e=>e.json())).then((e=>{token=e.access_token,localStorage.setItem("MusicianTokenSpotifySecret",token)})).catch((e=>{}))},search={getSearch(e){fetch("https://api.spotify.com/v1/search?q="+e+"&type=album%2Cartist",{method:"GET",headers:{Authorization:`Bearer ${token}`}}).then((e=>e.json())).then((e=>{this.tratamentoSearch(e)})).catch((e=>{}))},tratamentoSearch(e){if(null!=e.error)createToken(),this.getSearch();else{let t=e.albums,a=e.artists;t.items.forEach((e=>{let t=e.name,a=e.external_urls.spotify,r=e.images[0].url;null!=r&&this.createResults({nome:t,link:a,image:r,tipo:"albuns"})})),a.items.forEach((e=>{let t=e.name,a=e.external_urls.spotify,r=e.images[0].url;null!=r&&this.createResults({nome:t,link:a,image:r,tipo:"artistas"})}))}},createResults(e){let t="";"artistas"==e.tipo?t=document.querySelector("#artistas"):"albuns"==e.tipo&&(t=document.querySelector("#albuns"));let a=document.createElement("div");a.classList.add("item");let r=document.createElement("a");r.classList.add("card"),r.href=e.link,r.target="_blank";let o=document.createElement("div");o.classList.add("card-image");let s=document.createElement("img");s.src=e.image;let n=document.createElement("div");n.classList.add("card-text");let l=document.createElement("div");l.classList.add("card-text-title"),l.innerHTML=e.nome,o.appendChild(s),n.appendChild(l),r.appendChild(o),r.appendChild(n),a.appendChild(r),t.appendChild(a)}},listeners=()=>{document.querySelector(".form-control i").addEventListener("click",(e=>{let t=e.target.parentNode.querySelector("input");t.value.length<=3?t.parentNode.classList.contains("error")||t.parentNode.classList.add("error"):(t.parentNode.classList.contains("error")&&t.parentNode.classList.remove("error"),window.location.href="search.html?search="+t.value)}))};async function startAll(){if(document.querySelector(".form-control i").addEventListener("click",(e=>{let t=e.target.parentNode.querySelector("input");t.value.length<=3?t.parentNode.classList.contains("error")||t.parentNode.classList.add("error"):(t.parentNode.classList.contains("error")&&t.parentNode.classList.remove("error"),window.location.href="search.html?search="+t.value)})),$(".owl-carousel.skeleton-carousel").owlCarousel({margin:20,loop:!0,autoWidth:!0,items:9,autoplayTimeout:3e3,autoplayHoverPause:!1}),null==params.get("search")||""==params.get("search")||" "==params.get("search"))window.location.href="/";else{document.querySelector("input").value=params.get("search");document.querySelector(".carousels-title span").innerHTML=params.get("search");""!=token&&null!=token||await createToken(),new Promise(((e,t)=>{search.getSearch(String(params.get("search"))),setTimeout((()=>{e(!0)}),3e3)})).then((e=>{document.querySelectorAll(".owl-carousel.skeleton-carousel").forEach((e=>{e.remove()})),$(".owl-carousel").owlCarousel({margin:20,loop:!0,autoWidth:!0,items:9,autoplay:!0,autoplayTimeout:3e3,autoplayHoverPause:!1})})).catch((e=>{}))}}startAll();